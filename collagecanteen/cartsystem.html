<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canteen Cart | Responsive Food Ordering</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter Font -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Light gray background */
        }
    </style>
</head>
<body class="min-h-screen">

    <div class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
        <h1 class="text-3xl sm:text-4xl font-extrabold tracking-tight text-gray-900 mb-6">
            Your Order Basket
        </h1>
        <p class="text-lg text-gray-500 mb-8">
            Review your selected meals before heading to the checkout.
        </p>

        <!-- Main Cart Layout: Stacked on Mobile, Side-by-Side on Desktop -->
        <div class="flex flex-col lg:flex-row gap-8">

            <!-- 1. Cart Items List (Takes up more space on desktop) -->
            <div class="lg:w-2/3 bg-white p-6 rounded-xl shadow-lg h-fit">
                <h2 class="text-2xl font-semibold text-gray-800 border-b pb-4 mb-4">
                    Items (Total <span id="item-count">0</span>)
                </h2>
                <div id="cart-items-container" class="space-y-6 divide-y divide-gray-100">
                    <!-- Cart items will be rendered here by JavaScript -->
                </div>
            </div>

            <!-- 2. Order Summary (Takes up less space on desktop) -->
            <div class="lg:w-1/3 h-fit">
                <div class="sticky top-6 bg-white p-6 rounded-xl shadow-lg">
                    <h2 class="text-2xl font-semibold text-gray-800 border-b pb-4 mb-4">
                        Order Summary
                    </h2>
                    
                    <!-- Subtotals -->
                    <div class="space-y-3 text-sm text-gray-700 mb-6">
                        <div class="flex justify-between">
                            <span>Subtotal</span>
                            <span class="font-medium" id="subtotal">$0.00</span>
                        </div>
                        <div class="flex justify-between">
                            <span>University Service Fee (5%)</span>
                            <span class="font-medium" id="tax-fee">$0.00</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Delivery to Campus Location</span>
                            <span class="font-medium text-green-600" id="delivery-fee">FREE</span>
                        </div>
                    </div>

                    <!-- Grand Total -->
                    <div class="flex justify-between items-center pt-4 border-t border-gray-200">
                        <span class="text-xl font-bold text-gray-900">Order Total</span>
                        <span class="text-2xl font-extrabold text-blue-600" id="grand-total">$0.00</span>
                    </div>

                    <!-- Checkout Button -->
                    <button id="checkout-btn"
                        class="mt-6 w-full py-3 px-6 bg-blue-600 text-white font-semibold rounded-lg shadow-lg hover:bg-blue-700 transition duration-150 ease-in-out transform hover:scale-[1.01] focus:outline-none focus:ring-4 focus:ring-blue-500 focus:ring-opacity-50">
                        Proceed to Checkout
                    </button>
                    
                    <!-- Message Box for Alerts -->
                    <div id="message-box" class="hidden mt-4 p-3 text-sm rounded-lg text-center" role="alert"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Mock data for the canteen items
        let cartItems = [
            { id: 1, name: "Chicken & Veggie Burrito Bowl", price: 12.50, quantity: 2, imageUrl: "https://placehold.co/100x100/10B981/ffffff?text=Bowl" },
            { id: 2, name: "Grilled Halloumi Sandwich", price: 8.75, quantity: 1, imageUrl: "https://placehold.co/100x100/F59E0B/ffffff?text=Sandwich" },
            { id: 3, name: "Fresh Fruit Salad (Large)", price: 5.00, quantity: 3, imageUrl: "https://placehold.co/100x100/EF4444/ffffff?text=Fruit" },
        ];

        const TAX_RATE = 0.05; // 5% Service Fee
        const DELIVERY_FEE = 0.00; // Free delivery for campus locations

        const cartContainer = document.getElementById('cart-items-container');
        const subtotalEl = document.getElementById('subtotal');
        const taxFeeEl = document.getElementById('tax-fee');
        const deliveryFeeEl = document.getElementById('delivery-fee');
        const grandTotalEl = document.getElementById('grand-total');
        const itemCountEl = document.getElementById('item-count');
        const checkoutBtn = document.getElementById('checkout-btn');
        const messageBox = document.getElementById('message-box');

        // Utility function for message box (instead of alert)
        function showMessage(message, type = 'info') {
            messageBox.textContent = message;
            messageBox.className = "mt-4 p-3 text-sm rounded-lg text-center transition-opacity duration-300";
            
            if (type === 'success') {
                messageBox.classList.add('bg-green-100', 'text-green-800');
            } else if (type === 'error') {
                messageBox.classList.add('bg-red-100', 'text-red-800');
            } else { // info
                messageBox.classList.add('bg-blue-100', 'text-blue-800');
            }
            messageBox.classList.remove('hidden');

            setTimeout(() => {
                messageBox.classList.add('opacity-0');
                setTimeout(() => {
                    messageBox.classList.add('hidden');
                    messageBox.classList.remove('opacity-0');
                }, 300);
            }, 3000);
        }

        // --- Calculation Logic ---
        function calculateTotals() {
            let itemSubtotal = 0;
            let totalItems = 0;

            cartItems.forEach(item => {
                itemSubtotal += item.price * item.quantity;
                totalItems += item.quantity;
            });

            const taxFee = itemSubtotal * TAX_RATE;
            const grandTotal = itemSubtotal + taxFee + DELIVERY_FEE;

            // Update DOM
            itemCountEl.textContent = totalItems;
            subtotalEl.textContent = `$${itemSubtotal.toFixed(2)}`;
            taxFeeEl.textContent = `$${taxFee.toFixed(2)}`;
            grandTotalEl.textContent = `$${grandTotal.toFixed(2)}`;
        }

        // --- Render Logic ---
        function renderCart() {
            cartContainer.innerHTML = ''; // Clear previous content

            if (cartItems.length === 0) {
                cartContainer.innerHTML = '<p class="text-center text-gray-500 py-10">Your basket is empty. Add some delicious food!</p>';
                checkoutBtn.disabled = true;
                checkoutBtn.classList.add('opacity-50', 'cursor-not-allowed');
            } else {
                checkoutBtn.disabled = false;
                checkoutBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                
                cartItems.forEach(item => {
                    const itemElement = document.createElement('div');
                    itemElement.className = 'flex flex-col sm:flex-row items-start sm:items-center py-4';
                    
                    const itemTotalPrice = (item.price * item.quantity).toFixed(2);

                    itemElement.innerHTML = `
                        <!-- Image & Name -->
                        <div class="flex items-center flex-grow mb-3 sm:mb-0">
                            <img src="${item.imageUrl}" alt="${item.name}" 
                                class="w-20 h-20 rounded-lg object-cover mr-4 shadow-md" 
                                onerror="this.onerror=null;this.src='https://placehold.co/80x80/60A5FA/ffffff?text=Food'">
                            <div class="flex-grow">
                                <p class="text-base font-semibold text-gray-900">${item.name}</p>
                                <p class="text-sm text-gray-500 mt-1">Unit Price: <span class="font-medium">$${item.price.toFixed(2)}</span></p>
                            </div>
                        </div>

                        <!-- Quantity Control & Price -->
                        <div class="flex items-center justify-between w-full sm:w-auto sm:ml-auto">
                            <!-- Quantity Controls -->
                            <div class="flex items-center border border-gray-300 rounded-lg">
                                <button data-id="${item.id}" data-action="decrease"
                                    class="p-2 w-8 h-8 flex justify-center items-center text-gray-600 hover:bg-gray-100 rounded-l-lg transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4" />
                                    </svg>
                                </button>
                                <span class="w-8 text-center text-sm font-medium text-gray-900" data-quantity-display="${item.id}">
                                    ${item.quantity}
                                </span>
                                <button data-id="${item.id}" data-action="increase"
                                    class="p-2 w-8 h-8 flex justify-center items-center text-gray-600 hover:bg-gray-100 rounded-r-lg transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                                    </svg>
                                </button>
                            </div>
                            
                            <!-- Total Price for Item -->
                            <div class="w-24 text-right ml-4">
                                <p class="text-lg font-bold text-gray-900" data-item-total="${item.id}">
                                    $${itemTotalPrice}
                                </p>
                            </div>

                            <!-- Remove Button (Visible on all sizes) -->
                            <button data-id="${item.id}" data-action="remove"
                                class="text-red-500 hover:text-red-700 ml-4 p-2 rounded-full hover:bg-red-50 transition-colors"
                                title="Remove Item">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                </svg>
                            </button>
                        </div>
                    `;
                    cartContainer.appendChild(itemElement);
                });
            }
            calculateTotals();
        }

        // --- Event Handlers ---

        function handleQuantityUpdate(event) {
            const button = event.target.closest('button');
            if (!button) return;

            const id = parseInt(button.dataset.id);
            const action = button.dataset.action;

            if (isNaN(id) || !action) return;

            const itemIndex = cartItems.findIndex(item => item.id === id);
            if (itemIndex === -1) return;

            const item = cartItems[itemIndex];

            if (action === 'increase') {
                item.quantity += 1;
            } else if (action === 'decrease') {
                if (item.quantity > 1) {
                    item.quantity -= 1;
                } else {
                    // Remove item if quantity goes to 0
                    cartItems = cartItems.filter(i => i.id !== id);
                    renderCart();
                    showMessage(`${item.name} removed from basket.`, 'info');
                    return;
                }
            } else if (action === 'remove') {
                cartItems = cartItems.filter(i => i.id !== id);
                renderCart();
                showMessage(`${item.name} removed from basket.`, 'info');
                return;
            }

            // Update individual item display
            const newTotal = (item.price * item.quantity).toFixed(2);
            document.querySelector(`[data-quantity-display="${id}"]`).textContent = item.quantity;
            document.querySelector(`[data-item-total="${id}"]`).textContent = `$${newTotal}`;

            calculateTotals();
        }

        function handleCheckout() {
            if (cartItems.length > 0) {
                const totalAmount = grandTotalEl.textContent;
                showMessage(`Proceeding to payment for ${totalAmount}! (This is a mock checkout) - Thank you!`, 'success');
                // Here you would typically redirect to the payment page.
            } else {
                showMessage("Your basket is empty. Nothing to check out.", 'error');
            }
        }

        // Add main event listener to the cart container for all buttons
        cartContainer.addEventListener('click', handleQuantityUpdate);
        checkoutBtn.addEventListener('click', handleCheckout);

        // Initial rendering on load
        document.addEventListener('DOMContentLoaded', renderCart);
    </script>

</body>
</html>